{% comment %} 
  Styled Cart Section (for /cart page) 
  - Responsive layout 
  - Quantity stepper (- / +) 
  - Line item price + compare-at + discounts 
  - Cart note + subtotal + checkout 
{% endcomment %}


{{ 'cart.css' | asset_url | stylesheet_tag }}
<script src="{{ 'cart.js' |  asset_url }}" defer></script>

<section class="cart-page" data-cart-page>
  <div class="cart-wrap">
    <div class="cart-header">
      <div>
        <h1 class="cart-title">{{ 'cart.title' | t }}</h1>
        <p class="cart-subtitle">
          {% if cart.item_count == 1 %}
            1 item in your cart
          {% else %}
            {{ cart.item_count }} items in your cart
          {% endif %}
        </p>
      </div>

      <div class="cart-badge" aria-label="Cart subtotal">
        <span>Subtotal</span>
        <strong>{{ cart.total_price | money }}</strong>
      </div>
    </div>

    {% if cart.item_count == 0 %}
      <div class="cart-card">
        <div class="empty">
          <h2>Your cart is empty</h2>
          <p>Add something you like — it’ll show up here.</p>
          <a class="btn btn--primary" href="{{ routes.all_products_collection_url }}">
            Continue shopping
          </a>
        </div>
      </div>
    {% else %}

      <form
        action="{{ routes.cart_url }}"
        method="post"
        novalidate
        data-cart-form>
        <div class="cart-grid">
          <!-- LEFT: ITEMS -->
          <div class="cart-card">
            <div class="cart-card__header">
              <h2>Items</h2>
              <div class="cart-actions">
                <a class="btn btn--ghost" href="{{ routes.all_products_collection_url }}">Continue shopping</a>
                <button
                  class="btn update-hidden"
                  type="submit"
                  name="update">
                  {{ 'cart.update' | t }}
                </button>
              </div>
            </div>

            <div class="cart-items">
              {% for item in cart.items %}
                <div class="cart-item" data-line="{{ forloop.index }}">
                  <a
                    class="cart-item__img"
                    href="{{ item.url }}"
                    aria-label="{{ item.product.title | escape }}">
                    {% if item.image %}
                      <img
                        src="{{ item.image | image_url: width: 220 }}"
                        srcset="
                          {{ item.image | image_url: width: 160 }} 160w,
                          {{ item.image | image_url: width: 220 }} 220w,
                          {{ item.image | image_url: width: 320 }} 320w
                        "
                        sizes="(max-width: 640px) 84px, 92px"
                        width="92"
                        height="92"
                        loading="lazy"
                        alt="{{ item.image.alt | default: item.product.title | escape }}">
                    {% endif %}
                  </a>

                  <div class="cart-item__info">
                    <h3 class="cart-item__title">
                      <a href="{{ item.url }}">{{ item.product.title }}</a>
                    </h3>

                    <p style="color:rgb(131, 114, 114)">
                      {{ item.product.description }}
                    </p>

                    {% if item.variant.title and item.variant.title != 'Default Title' %}
                      <p class="cart-item__meta-text">{{ item.variant.title }}</p>
                    {% endif %}

                    {% if item.selling_plan_allocation %}
                      <span class="pill pill--ok">Subscription</span>
                    {% endif %}

                    {% if item.properties.size > 0 %}
                      <div>
                        {% for p in item.properties %}
                          {% assign first_char = p.first | slice: 0 %}
                          {% if p.last != blank and first_char != '_' %}
                            <span class="pill">{{ p.first }}: {{ p.last }}</span>
                          {% endif %}
                        {% endfor %}
                      </div>
                    {% endif %}

                    {% if item.discounts and item.discounts.size > 0 %}
                      <div>
                        {% for discount in item.discounts %}
                          <span class="pill pill--ok">Discount: {{ discount.title }}</span>
                        {% endfor %}
                      </div>
                    {% endif %}
                  </div>

                  <div class="cart-item__meta">
                    <div class="price-block">
                      {% assign compare = item.variant.compare_at_price %}
                      {% assign price = item.final_price %}
                      {% if compare and compare > item.original_price %}
                        <span class="compare">{{ compare | money }}</span>
                      {% endif %}

                      <div class="price">
                        {% if item.final_line_price != item.original_line_price %}
                          {{ item.final_line_price | money }}
                        {% else %}
                          {{ item.original_line_price | money }}
                        {% endif %}
                      </div>

                      {% if item.final_line_price != item.original_line_price %}
                        <div class="small">
                          Was {{ item.original_line_price | money }}
                        </div>
                      {% endif %}
                    </div>

                    <div>
                      <div
                        class="qty"
                        role="group"
                        aria-label="Quantity controls">
                        <button
                          type="button"
                          class="qty-btn"
                          data-qty-minus
                          aria-label="Decrease quantity">−</button>
                        <input
                          type="number"
                          inputmode="numeric"
                          name="updates[]"
                          value="{{ item.quantity }}"
                          min="0"
                          aria-label="Quantity"
                          data-qty-input>
                        <button
                          type="button"
                          class="qty-btn"
                          data-qty-plus
                          aria-label="Increase quantity">+</button>
                      </div>

                      <div class="item-links">
                        <a class="link" href="{{ item.url }}">View</a>
                        <a class="link link--danger" href="{{ item.url_to_remove }}">
                          {{ 'cart.remove' | t }}
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>

          <!-- RIGHT: SUMMARY -->
          <aside class="cart-card">
            <div class="summary">
              <h2>Order summary</h2>

              <div class="summary-row">
                <span>Items</span>
                <strong>
                  {% if cart.item_count == 1 %}
                    1
                  {% else %}
                    {{ cart.item_count }}
                  {% endif %}
                </strong>
              </div>

              {% if cart.total_discount > 0 %}
                <div class="summary-row">
                  <span>Discounts</span>
                  <strong>-{{ cart.total_discount | money }}</strong>
                </div>
              {% endif %}

              <div class="summary-row">
                <span>Subtotal</span>
                <strong>{{ cart.total_price | money }}</strong>
              </div>

              <div class="fineprint">
                Taxes and shipping calculated at checkout.
              </div>

              <div class="note">
                <label for="CartNote">Order note (optional)</label>
                <textarea
                  id="CartNote"
                  name="note"
                  placeholder="Add instructions for your order...">{{ cart.note }}</textarea>
              </div>

              <div class="checkout-actions">
                <button
                  class="btn btn--primary"
                  type="submit"
                  name="checkout">
                  {{ 'cart.checkout' | t }}
                </button>

                <button
                  class="btn"
                  type="submit"
                  name="update">
                  {{ 'cart.update' | t }}
                </button>

                {% if additional_checkout_buttons %}
                  <div class="additional-checkout-buttons">
                    {{ content_for_additional_checkout_buttons }}
                  </div>
                {% endif %}
              </div>
            </div>
          </aside>

        </div>
      </form>


    {% endif %}
  </div>
</section>

{% schema %}
  {
    "name": "t:general.cart",
    "settings": []
  }
{% endschema %}